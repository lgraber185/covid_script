from lxml import html
import requests
import smtplib, ssl
import time

while 1 == 1:
    try:	
        page = requests.get('https://www.publix.com/covid-vaccine/florida') # put site url here
        tree = html.fromstring(page.content)

        content = page.content

        #Vaccine Registration is Currently Full

        if 'All available COVID-19 vaccine appointments have been claimed' in page.text: # put placeholder text here
            print("No vaccines yet")
        else:
	        print("Maybe vaccines")
	        port = 465  # For SSL
	        password = 'password'
	        sender_email = "emailhere@gmail.com"  # Enter your address
	        receiver_email = "emailhere@gmail.com"  # Enter receiver address
		#note that gmail appears to block smtp email hyperlinks
	        message = "Check Publix health vaccine site now"
	        # Create a secure SSL context
	        context = ssl.create_default_context()
	        with smtplib.SMTP_SSL("smtp.gmail.com", port, context=context) as server:
		        server.login(sender_email, password)
		        server.sendmail(sender_email, receiver_email, message)
    except:
        print("site is down\n")
    time.sleep(240)
